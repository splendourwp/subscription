!function(a){var i=["powerpack","pp_section","pp_column"],t=["widget","column","section"];xdLocalStorage.init({iframeUrl:pp_magic_wand.cross_domain_cdn,initCallback:function(){}}),PPMWHandler={copy:function(e,n){xdLocalStorage.setItem("ppe_container_new",JSON.stringify({widgetType:e,widgetCode:n}))},paste:function(e,n){var i=null,t=(e=e.widgetCode,JSON.stringify(e)),a={elType:e.elType,settings:e.settings},o=/\.(jpg|jpeg|png|gif|svg)/gi.test(t),c=n,r=n.model.get("elType"),p={index:0};switch(e.elType){case"section":switch(a.elements=PPMWHandler.generateUniqueID(e.elements),i=elementor.getPreviewContainer(),r){case"widget":p.index=c.getContainer().parent.parent.view.getOption("_index")+1;break;case"column":p.index=c.getContainer().parent.view.getOption("_index")+1;break;case"section":p.index=c.getOption("_index")+1}break;case"column":switch(a.elements=PPMWHandler.generateUniqueID(e.elements),r){case"widget":i=c.getContainer().parent.parent,p.index=c.getContainer().parent.view.getOption("_index")+1;break;case"column":i=c.getContainer().parent,p.index=c.getOption("_index")+1;break;case"section":i=c.getContainer()}break;case"widget":switch(a.widgetType=e.widgetType,i=c.getContainer(),r){case"widget":i=c.getContainer().parent,p.index=c.getOption("_index")+1;break;case"column":i=c.getContainer();break;case"section":i=c.children.findByIndex(0).getContainer()}}var d=PPMWHandler.createElement(c,r,{model:a,container:i,options:p});o&&PPMWHandler.processMedia(d,t,function(e){var n,t;e.success&&(n=e.data[0],a.elType=n.elType,a.settings=n.settings,"widget"===n.elType?a.widgetType=n.widgetType:a.elements=n.elements,d.view.$el.removeClass("ppe-processing-import").attr("data-pp-processing-import-title","Image processing completed."),t=setTimeout(function(){$e.run("document/elements/delete",{container:d}),$e.run("document/elements/create",{model:a,container:i,options:p}),clearTimeout(t)},750))})},createElement:function(e,n,t){var i=$e.run("document/elements/create",t);return null==i&&("widget"===n?e.$el.next(".undefined.elementor-widget-empty")&&e.$el.next(".undefined.elementor-widget-empty").after('<div class="elementor-alert elementor-alert-warning">'+pp_magic_wand.widget_not_found+"</div>"):e.$el.find(".undefined.elementor-widget-empty")&&e.$el.find(".undefined.elementor-widget-empty").after('<div class="elementor-alert elementor-alert-warning">'+pp_magic_wand.widget_not_found+"</div>")),i},processMedia:function(e,n,t){a.ajax({url:pp_magic_wand.ajaxURL,method:"post",data:{nonce:pp_magic_wand.nonce,action:"pp_process_import",content:n},beforeSend:function(){e.view.$el.addClass("ppe-processing-import").attr("data-pp-processing-import-title","Processing images...")}}).done(function(e){"function"==typeof t&&t(e)})},generateUniqueID:function(e){return e.forEach(function(e,n){e.id=elementor.helpers.getUniqueID(),0<e.elements.length&&PPMWHandler.generateUniqueID(e.elements)}),e},getSectionData:function(e,n,t,i){void 0!==e&&void 0!==n&&(void 0===t&&(t=1),a.post(pp_magic_wand.ajaxURL,{action:"pp_get_section_data",post_id:e,section_id:n,nonce:t},function(e){e.success&&PPMWHandler.copy("section",e.data),"function"==typeof i&&i(e)}))}},"undefined"!=typeof elementor&&i.forEach(function(e,n){elementor.hooks.addFilter("elements/"+t[n]+"/contextMenuGroups",function(e,t){return e.push({name:i[n],actions:[{name:"copy",title:pp_magic_wand.pp_copy,icon:pp_magic_wand.cross_domain_icon,callback:function(){var e=t.model.get("widgetType"),n=t.model.toJSON();PPMWHandler.copy(e,n)}},{name:"paste",title:pp_magic_wand.pp_paste,icon:pp_magic_wand.cross_domain_icon,callback:function(){var n="";xdLocalStorage.getItem("ppe_container_new",function(e){n=JSON.parse(e.value),PPMWHandler.paste(n,t)})}}]}),e})})}(jQuery);